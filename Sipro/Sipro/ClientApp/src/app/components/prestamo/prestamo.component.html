<div fxLayout="column" fxLayoutAlign="center" fxFlexFill fxFlex>
    <div class="middle">
        <div fxLayout="column">
          <mat-card style="margin-top: 2%; background-color: #f5f5f5; border-color: #ddd;">
            Información General de Préstamos
          </mat-card>
        </div>
        <br>
        <div fxLayout="column" fxLayoutAlign="center" fxFlexFill>
          <div [hidden]="esColapsado">
            <div fxLayout="row" fxLayoutAlign="end" fxLayoutGap="2px">
              <button mat-raised-button style="background-color: #337ab7; color:#fff" (click)="nuevo()"><mat-icon>add</mat-icon>Nuevo</button>
              <button mat-raised-button style="background-color: #337ab7; color: #fff;" (click)="editar()"><mat-icon>mode_edit</mat-icon>Editar</button>
              <button mat-raised-button style="background-color: #d9534f; color: #fff;" (click)="borrar()"><mat-icon>delete</mat-icon>Borrar</button>
            </div>
            <br>
            <div fxLayout="row" fxLayoutAlign="end">
              <button mat-raised-button style="min-width: 35px; border-color: #ccc; color:#333" (click)="refresh()"><mat-icon>refresh</mat-icon></button>
            </div>
            <br>
            <div fxLayout="row">
                <mat-form-field fxFlex="50%">
                    <input matInput #search class="search" type="text" placeholder="Busqueda..." (keydown.enter)="filtrar(search.value)">
                    <mat-icon class="search-info" (click)="filtrar(search.value)" matSuffix>search</mat-icon>
                </mat-form-field>              
            </div> 
            <br>
            <div fxLayout="column">                           
                <ng2-smart-table [settings]="settings" [source]="source" (dblClickRow)="onDblClickRow($event)" (userRowSelect)="onSelectRow($event)"></ng2-smart-table>              
            </div>
            <br>
            <div fxLayout="row" fxLayoutAlign="end" style="font-weight: bold;">
              Total de Préstamos: {{totalPrestamos}}
            </div>
            <div fxLayout="column" fxLayoutAlign="center">
              <mat-paginator [length]="totalPrestamos" [hidePageSize]="true" [pageSize]="elementosPorPagina" 
              [showFirstLastButtons]="true" (page)="pageEvent = handlePage($event)">
              </mat-paginator>
            </div>
          </div>
          <div [hidden]="!esColapsado">
            <form #myForm="ngForm">
              <div fxLayout="row" fxLayoutAlign="start" class="nuevo-edicion">
                  <label>{{esnuevo == true ? 'Nuevo Préstamo' : 'Edición de Préstamo'}}</label>
              </div>
              <div fxLayout="row" fxLayoutAlign="end" fxLayoutGap="2px">
                  <button mat-raised-button style="background-color: #5cb85c; color:#fff; border-color: #4cae4c" [disabled]="!myForm.valid" (click)="guardar()"><mat-icon>save</mat-icon>Guardar</button>
                  <button mat-raised-button style="background-color: #337ab7; color: #fff;" (click)="IrATabla()"><mat-icon>list</mat-icon>Ir a Tabla</button>
              </div>
              <br>
              <div fxLayout="column">
                  <div [@.disabled]="true">
                      <mat-card>
                          <mat-card-content>
                              <mat-tab-group class="demo-tab-group" [(selectedIndex)]="tabActive">
                                  <mat-tab label="Préstamo" style="overflow: hidden;">
                                      <div class="demo-tab-content">
                                        <br>
                                        <div fxLayout="row" fxLayoutAlign="start">
                                            <label class="label-id">ID {{prestamo.id}}</label>
                                        </div>
                                        <br>
                                        <div fxLayout="column">
                                          <mat-form-field>                                        
                                            <input class="search-info" name="codigoPresupuestario" [(ngModel)]="prestamo.codigoPresupuestario" matInput placeholder="* Código presupuestario" 
                                            [readonly]="true" (click)="buscarCodigoPresupuestario()" [required]="true">
                                            <mat-icon class="search-info" matSuffix (click)="buscarCodigoPresupuestario()">search</mat-icon>
                                          </mat-form-field>
                                        </div>
                                        <div fxLayout="column">
                                          <mat-form-field>
                                            <input name="numeroPrestamo" [(ngModel)]="prestamo.numeroPrestamo" matInput placeholder="* Número de @project_tag" [required]="true">
                                          </mat-form-field>
                                        </div>
                                        <div fxLayout="column">
                                          <mat-form-field>
                                            <input name="proyectoPrograma" [(ngModel)]="prestamo.proyectoPrograma" matInput placeholder="* Proyecto/Programa" [required]="true">
                                          </mat-form-field>
                                        </div>
                                        <div fxLayout="column">
                                          <mat-form-field>
                                            <input name="cooperantenombre" [(ngModel)]="prestamo.cooperantenombre" matInput placeholder="* Organismo Financiero Internacional" [required]="true">
                                          </mat-form-field>
                                        </div>
                                        <div fxLayout="column">
                                          <mat-form-field>
                                            <input name="sectorEconomico" [(ngModel)]="prestamo.sectorEconomico" matInput placeholder="Sector Económico">
                                          </mat-form-field>
                                        </div>
                                        <div fxLayout="row" fxLayoutGap="15px">
                                          <mat-form-field fxFlex="33.33%">
                                            <input matInput [matDatepicker]="fechaElegibilidadUe" placeholder="* Fecha de Elegibilidad"  
                                              name="fechaElegibilidadUe" [(ngModel)]="prestamo.fechaElegibilidadUe" [required]="true" (ngModelChange)="setPorcentaje(5)">
                                            <mat-datepicker-toggle matSuffix [for]="fechaElegibilidadUe"></mat-datepicker-toggle>
                                            <mat-datepicker #fechaElegibilidadUe></mat-datepicker>
                                          </mat-form-field>
          
                                          <mat-form-field fxFlex="33.33%">
                                            <input matInput [matDatepicker]="fechaSuscripcion" placeholder="* Fecha de Suscripción"
                                              name="fechaSuscripcion" [(ngModel)]="prestamo.fechaSuscripcion" [required]="true">
                                            <mat-datepicker-toggle matSuffix [for]="fechaSuscripcion"></mat-datepicker-toggle>
                                            <mat-datepicker #fechaSuscripcion></mat-datepicker>
                                          </mat-form-field>
          
                                          <mat-form-field fxFlex="33.33%">
                                            <input matInput [matDatepicker]="fechaVigencia" placeholder="* Fecha de vigencia"
                                              name="fechaVigencia" [(ngModel)]="prestamo.fechaVigencia" [required]="true">
                                            <mat-datepicker-toggle matSuffix [for]="fechaVigencia"></mat-datepicker-toggle>
                                            <mat-datepicker #fechaVigencia></mat-datepicker>
                                          </mat-form-field>
                                        </div>
                                        <div fxLayout="row" fxLayoutGap="15px">
                                          <mat-form-field fxFlex="33.33%">
                                            <input matInput [matDatepicker]="fechaCierreOrigianlUe" placeholder="* Fecha de Cierre Original"
                                              name="fechaCierreOrigianlUe" [(ngModel)]="prestamo.fechaCierreOrigianlUe" [required]="true" (ngModelChange)="setPorcentaje(5)">
                                            <mat-datepicker-toggle matSuffix [for]="fechaCierreOrigianlUe"></mat-datepicker-toggle>
                                            <mat-datepicker #fechaCierreOrigianlUe></mat-datepicker>
                                          </mat-form-field>
          
                                          <mat-form-field fxFlex="33.33%">
                                            <input matInput [matDatepicker]="fechaCierreActualUe" placeholder="* Fecha de Cierre Actual"
                                              name="fechaCierreActualUe" [(ngModel)]="prestamo.fechaCierreActualUe" [required]="true" (ngModelChange)="setPorcentaje(5)">
                                            <mat-datepicker-toggle matSuffix [for]="fechaCierreActualUe"></mat-datepicker-toggle>
                                            <mat-datepicker #fechaCierreActualUe></mat-datepicker>
                                          </mat-form-field>
          
                                          <mat-form-field fxFlex="33.33%">
                                            <input name="mesesProrrogaUe" [(ngModel)]="prestamo.mesesProrrogaUe" matInput placeholder="* Meses de Prórroga" [required]="true" [readonly]="true">
                                          </mat-form-field>
                                        </div>
                                        <div fxLayout="row" fxLayoutGap="15px">
                                          <mat-form-field fxFlex="50%">
                                            <input name="plazoEjecucionUe" [(ngModel)]="prestamo.plazoEjecucionUe" matInput placeholder="Plazo de Ejecución %" [readonly]="true">
                                          </mat-form-field>
          
                                          <mat-form-field fxFlex="50%">
                                            <input name="saldoCuentas" [(ngModel)]="prestamo.saldoCuentas" matInput type="number" placeholder="Saldo de Cuentas">
                                          </mat-form-field>
                                        </div>
                                        <div fxLayout="row" fxLayoutGap="15px">
                                          <mat-form-field fxFlex="50%">                                        
                                            <input class="search-info" name="tipoMonedaNombre" [(ngModel)]="prestamo.tipoMonedaNombre" matInput placeholder="* Tipo de Moneda" 
                                              [readonly]="true" (click)="buscarTipoMoneda()" [required]="true">
                                            <mat-icon class="search-info" matSuffix (click)="buscarTipoMoneda()">search</mat-icon>
                                          </mat-form-field>
          
                                          <mat-form-field fxFlex="50%">
                                            <input name="montoContratado" [(ngModel)]="prestamo.montoContratado" (ngModelChange)="setPorcentaje(1)" [required]="true"
                                              matInput type="number" placeholder="* Monto Contratado">
                                          </mat-form-field>
                                        </div>
                                        <div fxLayout="row" fxLayoutGap="15px">
                                          <mat-form-field fxFlex="50%">
                                            <input name="montoContratadoUsd" [(ngModel)]="prestamo.montoContratadoUsd" (ngModelChange)="setPorcentaje(2)" [required]="true" 
                                              matInput type="number" placeholder="* Monto Contratado Equivalente $">
                                          </mat-form-field>
          
                                          <mat-form-field fxFlex="50%">
                                            <input name="montoContratadoQtz" [(ngModel)]="prestamo.montoContratadoQtz" matInput type="number" [required]="true"
                                              placeholder="* Monto Contratado Equivalente Q">
                                          </mat-form-field>
                                        </div>
                                        <div fxLayout="row" fxLayoutGap="15px">
                                          <mat-form-field fxFlex="50%">
                                            <input name="desembolsoAFechaUsd" [(ngModel)]="prestamo.desembolsoAFechaUsd" (ngModelChange)="setPorcentaje(1)" [required]="true" 
                                              matInput type="number" placeholder="* Desembolso a la Fecha $">
                                          </mat-form-field>
          
                                          <mat-form-field fxFlex="50%">
                                            <input name="desembolsoAFechaUsdP" [(ngModel)]="prestamo.desembolsoAFechaUsdP" matInput placeholder="Desembolso a la Fecha %" [readonly]="true">
                                          </mat-form-field>
                                        </div>
                                        <div fxLayout="row" fxLayoutGap="15px">
                                          <mat-form-field fxFlex="50%">
                                            <input name="montoPorDesembolsarUsd" [(ngModel)]="prestamo.montoPorDesembolsarUsd" (ngModelChange)="setPorcentaje(2)" [required]="true" 
                                              matInput type="number" placeholder="* Monto por Desembolsar $">
                                          </mat-form-field>
          
                                          <mat-form-field fxFlex="50%">
                                            <input name="montoPorDesembolsarUsdP" [(ngModel)]="prestamo.montoPorDesembolsarUsdP" matInput placeholder="Monto por Desembolsar %" [readonly]="true">
                                          </mat-form-field>
                                        </div>
                                        <div fxLayout="row" fxLayoutGap="15px">
                                          <mat-form-field fxFlex="50%">
                                            <input matInput [matDatepicker]="fechaDecreto" placeholder="* Fecha Decreto"
                                              name="fechaDecreto" [(ngModel)]="prestamo.fechaDecreto" [required]="true">
                                            <mat-datepicker-toggle matSuffix [for]="fechaDecreto"></mat-datepicker-toggle>
                                            <mat-datepicker #fechaDecreto></mat-datepicker>
                                          </mat-form-field>
          
                                          <mat-form-field fxFlex="50%">
                                            <input name="numeroAutorizacion" [(ngModel)]="prestamo.numeroAutorizacion" matInput placeholder="Número de Decreto">
                                          </mat-form-field>
                                        </div>
                                        <div fxLayout="column">
                                          <mat-form-field>
                                            <input type="number" name="porcentajeAvance" [(ngModel)]="prestamo.porcentajeAvance" matInput placeholder="Avance del Préstamo %">
                                          </mat-form-field>
                                        </div>
                                        <div fxLayout="column">
                                          <mat-form-field>
                                            <textarea name="objetivo" matInput rows="4" [(ngModel)]="prestamo.objetivo" placeholder="Objetivo del Préstamo"></textarea>
                                          </mat-form-field>
                                        </div>
                                        <div fxLayout="column">
                                          <mat-form-field>
                                            <textarea name="objetivoEspecifico" matInput rows="4" [(ngModel)]="prestamo.objetivoEspecifico" placeholder="Objetivos específicos del Préstamo"></textarea>
                                          </mat-form-field>
                                        </div>
                                        <br>
                                        <div fxLayout="column">
                                          <h5 fxLayoutAlign="center">Tipo de préstamo</h5>
                                          <div style="text-align: right;">
                                            <button mat-raised-button style="min-width: 35px; border-color: #ccc; color:#333" (click)="buscarTiposPrestamo()" matTooltip="Asignar un tipo de préstamo"><mat-icon>add</mat-icon></button>
                                          </div>
                                          <br>
                                          <div>
                                            <ng2-smart-table [settings]="settingsTipoPrestamo" [source]="sourceTipoPrestamo"></ng2-smart-table>              
                                          </div>
                                        </div>
                                        <div fxLayout="column">
                                          <h5 fxLayoutAlign="center">Archivos adjuntos</h5>
                                          <div style="text-align: right;">
                                            <button mat-raised-button style="min-width: 35px; border-color: #ccc; color:#333" (click)="adjuntarDocumentos()" matTooltip="Adjuntar documento"><mat-icon>add</mat-icon></button>
                                          </div>
                                          <br>
                                          <div>
                                            <ng2-smart-table [settings]="settingsArchivosAdjuntos" [source]="sourceArchivosAdjuntos"></ng2-smart-table>              
                                          </div>
                                        </div>
                                        <br>
                                        <div fxLayout="column">
                                            <div class="panel panel-default" style="height: 180px;">
                                                <div class="panel-heading label-form" fxLayoutAlign="center">Datos de auditoría</div>
                                                <div class="panel-body">
                                                  <div>
                                                    <div fxLayout="row" fxLayoutGap="20px">
                                                      <div fxFlex="50%">
                                                        <label fxLayoutAlign="end" class="label-form" for="usuarioCreo">Usuario que creo</label>
                                                        <p fxLayoutAlign="end">{{ prestamo.usuarioCreo }}</p>
                                                      </div>
                
                                                      <div fxFlex="50%">
                                                          <label fxLayoutAlign="start" class="label-form"  for="fechaCreacion">Fecha de creación</label>
                                                          <p fxLayoutAlign="start">{{ prestamo.fechaCreacion }}</p>
                                                      </div>
                                                    </div>
                                                    <div fxLayout="row" fxLayoutGap="20px">
                                                        <div fxFlex="50%">
                                                          <label fxLayoutAlign="end" class="label-form" for="usuarioActualizo">Usuario que actualizo</label>
                                                          <p fxLayoutAlign="end">{{ prestamo.usuarioActualizo }}</p>
                                                        </div>
                
                                                        <div fxFlex="50%">
                                                          <label fxLayoutAlign="start" for="fechaActualizacion"  class="label-form" >Fecha de actualizacion</label>
                                                          <p fxLayoutAlign="start">{{ prestamo.fechaActualizacion }}</p>
                                                        </div>
                                                    </div>
                                                  </div>                                  
                                                </div>
                                            </div>
                                        </div>
                                      </div>
                                  </mat-tab>
                                  <mat-tab *ngIf="false" label="Configuraciones Préstamo" >
                                      <div class="demo-tab-content">
                                        <br>
                                        <div fxLayout="column">
                                          <mat-form-field fxFlex="50%">
                                              <input name="montoAsignadoUe" [(ngModel)]="prestamo.montoAsignadoUe" matInput type="number" placeholder="* Monto Asignado" [required]="true">
                                          </mat-form-field>
                                        </div>
                                        <div fxLayout="row" fxLayoutGap="15px">
                                          <mat-form-field fxFlex="50%">
                                              <input name="montoAsignadoUeUsd" [(ngModel)]="prestamo.montoAsignadoUeUsd" matInput type="number" placeholder="* Monto Asignado $" 
                                                [required]="true" (ngModelChange)="setPorcentaje(3)">
                                          </mat-form-field>
    
                                          <mat-form-field fxFlex="50%">
                                              <input name="montoAsignadoUeQtz" [(ngModel)]="prestamo.montoAsignadoUeQtz" matInput type="number" placeholder="* Monto Asignado Q" [required]="true">
                                          </mat-form-field>
                                        </div>
                                        <div fxLayout="row" fxLayoutGap="15px">
                                            <mat-form-field fxFlex="50%">
                                                <input name="desembolsoAFechaUeUsd" [(ngModel)]="prestamo.desembolsoAFechaUeUsd" matInput type="number" placeholder="* Desembolso a la Fecha $" 
                                                  [required]="true" (ngModelChange)="setPorcentaje(3)">
                                            </mat-form-field>
    
                                            <mat-form-field fxFlex="50%">
                                                <input name="desembolsoAFechaUeUsdP" [(ngModel)]="prestamo.desembolsoAFechaUeUsdP" matInput type="number" placeholder="* Desembolso a la Fecha %" [required]="true">
                                            </mat-form-field>
                                        </div>
                                        <div fxLayout="row" fxLayoutGap="15px">
                                            <mat-form-field fxFlex="50%">
                                                <input name="montoPorDesembolsarUeUsd" [(ngModel)]="prestamo.montoPorDesembolsarUeUsd" matInput type="number" placeholder="* Monto por desembolsar $" 
                                                  [required]="true" (ngModelChange)="setPorcentaje(4)">
                                            </mat-form-field>
    
                                            <mat-form-field fxFlex="50%">
                                                <input name="montoPorDesembolsarUeUsdP" [(ngModel)]="prestamo.montoPorDesembolsarUeUsdP" matInput type="number" placeholder="Monto por desembolsar %" [required]="true">
                                            </mat-form-field>
                                        </div>
                                      </div>
                                  </mat-tab>
                                  <mat-tab label="Presupuesto">
                                      <div class="demo-tab-content">
                                        <br>
                                        <div fxLayout="column">
                                          <mat-form-field>
                                            <input type="number" name="presupuestoAsignadoFuncionamiento" [(ngModel)]="prestamo.presupuestoAsignadoFuncionamiento" matInput placeholder="P. Asignado Funcionamiento" [required]="true">
                                          </mat-form-field>
                                        </div>
                                        <div fxLayout="column">
                                          <mat-form-field>
                                            <input type="number" name="presupuestoVigenteFun" [(ngModel)]="prestamo.presupuestoVigenteFun" matInput placeholder="P. Vigente Funcionamiento" [required]="true">
                                          </mat-form-field>
                                        </div>
                                        <div fxLayout="column">
                                          <mat-form-field>
                                            <input type="number" name="presupuestoDevengadoFun" [(ngModel)]="prestamo.presupuestoDevengadoFun" matInput placeholder="P. Devengado Funcionamiento" [required]="true">
                                          </mat-form-field>
                                        </div>
                                        <div *ngIf="false">
                                          
                                        </div>
                                      </div>
                                  </mat-tab>
                                  <mat-tab label="Unidades Ejecutoras">
                                      <div class="demo-tab-content">
                                        <table class="table table-striped" style="margin-top: 15px;" fxFlexFill>
                                          <thead>
                                            <tr>
                                              <th class="label-form" style="text-align: center;">Coordinadora</th>
                                              <th class="label-form" style="text-align: center;">Organismo ejecutor</th>
                                              <th class="label-form" style="text-align: center;">Entidad</th>
                                              <th class="label-form" style="text-align: center;">Fecha Elegibilidad</th>
                                              <th class="label-form" style="text-align: center;">Fecha Cierre</th>
                                            </tr>
                                          </thead>
                                          <tbody>
                                            <tr *ngFor="let row of unidadesEjecutoras; let i=index" style="font-weight: normal;">
                                              <td>
                                                <input type="checkbox" [(ngModel)]="row.esCoordinador" name="esCoordinador"
                                                (ngModelChange) = "cambiarCoordinador(i)" 
                                                [readonly]="m_existenDatos"/>
                                              </td>
                                              <td class="divisionColumna truncate" style="">
                                                <div style="height: 25px;">
                                                  <div style="text-align: left">{{row.nombre}}</div>
                                                </div>
                                              </td>
                                              <td class="divisionColumna truncate" style="">
                                                <div style="height: 25px;">
                                                  <div style="text-align: left">{{row.entidad}}</div>
                                                </div>
                                              </td>
                                              <td>
                                                <div>
                                                  <mat-form-field>
                                                    <input matInput [matDatepicker]="UEfechaElegibilidad" placeholder="Fecha de Elegibilidad"
                                                      name="UEfechaElegibilidad" [(ngModel)]="row.fechaElegibilidad" [readonly]="m_existenDatos">
                                                    <mat-datepicker-toggle matSuffix [for]="UEfechaElegibilidad"></mat-datepicker-toggle>
                                                    <mat-datepicker #UEfechaElegibilidad></mat-datepicker>
                                                  </mat-form-field>
                                                </div>			
                                              </td>
                                              <td>
                                                <div>
                                                  <mat-form-field>
                                                    <input matInput [matDatepicker]="UEfechaCierre" placeholder="Fecha de Cierre"
                                                      name="UEfechaCierre" [(ngModel)]="row.fechaCierre" [readonly]="m_existenDatos">
                                                    <mat-datepicker-toggle matSuffix [for]="UEfechaCierre"></mat-datepicker-toggle>
                                                    <mat-datepicker #UEfechaCierre></mat-datepicker>
                                                  </mat-form-field>
                                                </div>
                                              </td>
                                            </tr>		
                                          </tbody>
                                        </table>
                                      </div>
                                  </mat-tab>
                                  <mat-tab label="Componentes">
                                      <div class="demo-tab-content">
                                          <br>
                                          <table class="table table-striped table-hover" style="margin-top: 15px;" fxFlexFill>
                                            <thead>
                                              <tr>
                                                <th class="label-form" style="text-align: center; ">Nombre</th>
                                                <th class="label-form" style="text-align: center; width: 100px;">Tipo Moneda</th>
                                                <th class="label-form" style="text-align: center; width: 155px;">Techo</th>
                                              </tr>
                                            </thead>
                                            <tbody>
                                              <tr *ngFor="let row of componentes; let i=index" style="font-weight: normal;">
                                                <td colspan="3">
                                                  <table style="width: 100%">
                                                    <tr (click)="toggle[row.id] = !toggle[row.id]; expandRowComponentes(row, i)">
                                                      <td fxLayoutAlign="start" fxFlex="70%">
                                                        <span [hidden]="row.mostrar"><mat-icon>add_circle</mat-icon></span>
                                                        <span [hidden]="!row.mostrar"><mat-icon>remove_circle</mat-icon></span>
                                                        {{row.nombre}}
                                                      </td>
                                                      <td fxLayoutAlign="center" fxFlex="15%">
                                                        {{row.tipoMoneda}}
                                                      </td>
                                                      <td fxLayoutAlign="end" fxFlex="15%">
                                                        {{row.techo | FormatoMillonesSinTipo: false}}
                                                      </td>
                                                    </tr>
                                                    <tr [hidden]="!toggle[row.id]">
                                                      <td colspan="3" style="padding: 10px 0px 0px 0px;">
                                                        <mat-form-field>
                                                          <textarea rows="4"  
                                                            [(ngModel)]="row.descripcion"
                                                            name="descripcion"
                                                            matInput
                                                            rows="4"
                                                            ng-maxlength="4000" placeholder="Descripción">
                                                          </textarea>
                                                        </mat-form-field>							
                                                      </td>
                                                    </tr>
                                                  </table>
                                                </td>
                                              </tr>
                                            </tbody>
                                          </table>
                                      </div>
                                  </mat-tab>
                                  <mat-tab label="Distribución de Unidad Ejecutora">
                                      <div class="demo-tab-content">
                                        <br>
                                        <div fxLayout="row" fxLayoutAlign="start">
                                          <button mat-raised-button style="min-width: 35px; border-color: #ccc; color:#333" (click)="verHistoria()"><mat-icon>history</mat-icon></button>
                                        </div>
                                        <br>
                                        <div fxLayout="row">
                                          <div class="divTabla">
                                            <table class="table">
                                              <tr>
                                                <th rowspan="2" class="label-form" style="vertical-align: middle;"> COMPONENTES</th>
                                                <th colspan="3"  class="label-form" *ngFor= "let organismo of m_organismosEjecutores;"
                                                  style="text-align: center; vertical-align: middle;">
                                                  <div>{{ organismo.nombre }}</div>
                                                </th>
                                                <th rowspan="2" class="label-form" style="text-align: center; vertical-align: middle;">Total Asignado</th>
                                                <th rowspan="2" class="label-form" style="text-align: center; vertical-align: middle;">TECHO</th>
                                              </tr>
                                              <tr>
                                                <th colspan="3" *ngFor= "let organismo of m_organismosEjecutores;">
                                                  <table style="width: 100%">
                                                    <tr>
                                                      <td class="label-form" style="min-width: 100px; text-align: center;">Prestamo</td>
                                                      <td class="label-form" style="min-width: 100px; text-align: center;">Donación</td>
                                                      <td class="label-form" style="min-width: 100px;text-align: center;">Nacional</td>
                                                    </tr>
                                                  </table>
                                                </th>
                                              </tr>
                                              
                                              <tr *ngFor="let row of m_componentes; let i=index " class="filaIngreso" style="font-weight: normal;"
                                                (click)="componenteSeleccionado(row)" [ngClass]="row.isSelected ? 'st-selected' : ''">
                                                <td style="min-width: 200px;" class="label-form"> {{ row.nombre }} </td>
                                                <td  colspan="3" *ngFor = "let ue of row.unidadesEjecutoras; let k=index">
                                                  <table style="width: 100%;">
                                                    <tr>
                                                      <td style="text-align: center;">
                                                        <input style="width: 100px; margin-right: 5px;" name="prestamo" 
                                                          [(ngModel)]="ue.prestamo" matInput 
                                                          (ngModelChange)="actualizarTotalesUE(); actualizarComponentes()"
                                                        />															
                                                      </td>
                                                      <td style="text-align: center;">
                                                        <input type="number" style="width: 100px; margin-right: 5px;" name="donacion" 
                                                          [(ngModel)]="ue.donacion" matInput
                                                          [readonly]="m_existenDatos" 
                                                          (ngModelChange)="actualizarTotalesUE(); actualizarComponentes()"
                                                        />							
                                                      </td>
                                                      <td style="text-align: center; border-right: 1px solid #ddd;">
                                                        <input type="number" style="width: 100px; margin-right: 5px;" name="nacional" 
                                                          [(ngModel)]="ue.nacional" matInput
                                                          [readonly]="m_existenDatos" 
                                                          (ngModelChange)="actualizarTotalesUE(); actualizarComponentes()"
                                                        />
                                                      </td>
                                                    <tr>
                                                  </table>
                                                </td>
                                                <td style="min-width: 100px; text-align: right;"
                                                  [ngClass]="{'totalCorrecto': row.totalIngresado==row.techo, 'totalError': row.totalIngresado!=row.techo}"
                                                  class="label-form"> {{ row.totalIngresado | FormatoMillonesSinTipo : false }} 
                                                 </td>
                                                <td style="width: 155px; text-align: right;"
                                                  [ngClass]="{'totalCorrecto': row.totalIngresado==row.techo, 'totalError': row.totalIngresado!=row.techo}"
                                                  class="label-form"> {{ row.techo | FormatoMillonesSinTipo : false }} 
                                                 </td>				 
                                              </tr>
                                              <tr style="border-top: 3px double #ddd;" >
                                                <td style="min-width: 200px;" class="label-form">
                                                  Total Asignado
                                                </td>
                                                <td  colspan="3" *ngFor = "let organismo of m_organismosEjecutores">
                                                  <table style="width: 100%;">
                                                    <tr>
                                                      <td style="text-align: right; width: 100px; padding-right: 5px;" class="label-form">
                                                        {{ organismo.totalAsignadoPrestamo | FormatoMillonesSinTipo : false }}
                                                      </td>
                                                      <td style="text-align: right; width: 100px; padding-right: 5px;" class="label-form">
                                                        {{ organismo.totalAsignadoDonacion | FormatoMillonesSinTipo : false }}
                                                      </td>
                                                      <td style="text-align: right; border-right: 1px single #ddd; width: 100px; padding-right: 5px;" class="label-form">
                                                        {{ organismo.totalAsignadoNacional | FormatoMillonesSinTipo : false }}
                                                      </td>
                                                    <tr>
                                                  </table>
                                                </td>
                                              </tr>
                                            </table>
                                          </div>
                                        </div>
                                      </div>
                                  </mat-tab>
                                  <mat-tab label="Indicadores">
                                      <div class="demo-tab-content">
                                        
                                      </div>
                                  </mat-tab>
                                  <mat-tab label="Riesgos">
                                      <div class="demo-tab-content">
                                        
                                      </div>
                                  </mat-tab>
                              </mat-tab-group>
                          </mat-card-content>
                      </mat-card>
                  </div>                  
                  <br>
                  <div fxLayout="row" fxLayoutAlign="end" fxLayoutGap="2px">
                    <button mat-raised-button style="background-color: #5cb85c; color:#fff; border-color: #4cae4c" [disabled]="!myForm.valid" (click)="guardar()"><mat-icon>save</mat-icon>Guardar</button>
                    <button mat-raised-button style="background-color: #337ab7; color: #fff;" (click)="IrATabla()"><mat-icon>list</mat-icon>Ir a Tabla</button>
                  </div>
              </div>
            </form>
          </div>
        </div>
      </div>
</div>
